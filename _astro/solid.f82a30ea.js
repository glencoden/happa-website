const p={context:void 0,registry:void 0};function k(t){p.context=t}function H(){return{...p.context,id:`${p.context.id}${p.context.count++}-`,count:0}}const L=(t,e)=>t===e,Q=Symbol("solid-proxy"),V=Symbol("solid-track"),y={equals:L};let j=T;const h=1,v=2,$={owned:null,cleanups:null,context:null,owner:null};var i=null;let C=null,o=null,c=null,f=null,A=0;function W(t,e){const s=o,n=i,u=t.length===0,r=u?$:{owned:null,cleanups:null,context:null,owner:e===void 0?n:e},l=u?t:()=>t(()=>a(()=>m(r)));i=r,o=null;try{return d(l,!0)}finally{o=s,i=n}}function X(t,e){e=e?Object.assign({},y,e):y;const s={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=u=>(typeof u=="function"&&(u=u(s.value)),N(s,u));return[q.bind(s),n]}function Y(t,e,s){const n=O(t,e,!1,h);x(n)}function w(t,e,s){s=s?Object.assign({},y,s):y;const n=O(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=s.equals||void 0,x(n),q.bind(n)}function z(t){return d(t,!1)}function a(t){if(o===null)return t();const e=o;o=null;try{return t()}finally{o=e}}function B(t){return i===null||(i.cleanups===null?i.cleanups=[t]:i.cleanups.push(t)),t}function J(){return o}function P(t){const e=w(t),s=w(()=>E(e()));return s.toArray=()=>{const n=s();return Array.isArray(n)?n:n!=null?[n]:[]},s}function q(){if(this.sources&&this.state)if(this.state===h)x(this);else{const t=c;c=null,d(()=>S(this),!1),c=t}if(o){const t=this.observers?this.observers.length:0;o.sources?(o.sources.push(this),o.sourceSlots.push(t)):(o.sources=[this],o.sourceSlots=[t]),this.observers?(this.observers.push(o),this.observerSlots.push(o.sources.length-1)):(this.observers=[o],this.observerSlots=[o.sources.length-1])}return this.value}function N(t,e,s){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&d(()=>{for(let u=0;u<t.observers.length;u+=1){const r=t.observers[u],l=C&&C.running;l&&C.disposed.has(r),(l?!r.tState:!r.state)&&(r.pure?c.push(r):f.push(r),r.observers&&U(r)),l||(r.state=h)}if(c.length>1e6)throw c=[],new Error},!1)),e}function x(t){if(!t.fn)return;m(t);const e=i,s=o,n=A;o=i=t,G(t,t.value,n),o=s,i=e}function G(t,e,s){let n;try{n=t.fn(e)}catch(u){return t.pure&&(t.state=h,t.owned&&t.owned.forEach(m),t.owned=null),t.updatedAt=s+1,M(u)}(!t.updatedAt||t.updatedAt<=s)&&(t.updatedAt!=null&&"observers"in t?N(t,n):t.value=n,t.updatedAt=s)}function O(t,e,s,n=h,u){const r={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:i,context:null,pure:s};return i===null||i!==$&&(i.owned?i.owned.push(r):i.owned=[r]),r}function R(t){if(t.state===0)return;if(t.state===v)return S(t);if(t.suspense&&a(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<A);)t.state&&e.push(t);for(let s=e.length-1;s>=0;s--)if(t=e[s],t.state===h)x(t);else if(t.state===v){const n=c;c=null,d(()=>S(t,e[0]),!1),c=n}}function d(t,e){if(c)return t();let s=!1;e||(c=[]),f?s=!0:f=[],A++;try{const n=t();return I(s),n}catch(n){s||(f=null),c=null,M(n)}}function I(t){if(c&&(T(c),c=null),t)return;const e=f;f=null,e.length&&d(()=>j(e),!1)}function T(t){for(let e=0;e<t.length;e++)R(t[e])}function S(t,e){t.state=0;for(let s=0;s<t.sources.length;s+=1){const n=t.sources[s];if(n.sources){const u=n.state;u===h?n!==e&&(!n.updatedAt||n.updatedAt<A)&&R(n):u===v&&S(n,e)}}}function U(t){for(let e=0;e<t.observers.length;e+=1){const s=t.observers[e];s.state||(s.state=v,s.pure?c.push(s):f.push(s),s.observers&&U(s))}}function m(t){let e;if(t.sources)for(;t.sources.length;){const s=t.sources.pop(),n=t.sourceSlots.pop(),u=s.observers;if(u&&u.length){const r=u.pop(),l=s.observerSlots.pop();n<u.length&&(r.sourceSlots[l]=n,u[n]=r,s.observerSlots[n]=l)}}if(t.owned){for(e=t.owned.length-1;e>=0;e--)m(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0,t.context=null}function M(t){throw t}function E(t){if(typeof t=="function"&&!t.length)return E(t());if(Array.isArray(t)){const e=[];for(let s=0;s<t.length;s++){const n=E(t[s]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}let D=!1;function Z(){D=!0}function _(t,e){if(D&&p.context){const s=p.context;k(H());const n=a(()=>t(e||{}));return k(s),n}return a(()=>t(e||{}))}const F=t=>`Stale read from <${t}>.`;function tt(t){const e=t.keyed,s=w(()=>t.when,void 0,{equals:(n,u)=>e?n===u:!n==!u});return w(()=>{const n=s();if(n){const u=t.children;return typeof u=="function"&&u.length>0?a(()=>u(e?n:()=>{if(!a(s))throw F("Show");return t.when})):u}return t.fallback},void 0,void 0)}function et(t){let e=!1;const s=(r,l)=>r[0]===l[0]&&(e?r[1]===l[1]:!r[1]==!l[1])&&r[2]===l[2],n=P(()=>t.children),u=w(()=>{let r=n();Array.isArray(r)||(r=[r]);for(let l=0;l<r.length;l++){const b=r[l].when;if(b)return e=!!r[l].keyed,[l,b,r[l]]}return[-1]},void 0,{equals:s});return w(()=>{const[r,l,b]=u();if(r<0)return t.fallback;const g=b.children;return typeof g=="function"&&g.length>0?a(()=>g(e?l:()=>{if(a(u)[0]!==r)throw F("Match");return b.when})):g},void 0,void 0)}function nt(t){return t}export{Q as $,nt as M,tt as S,Y as a,et as b,_ as c,V as d,z as e,X as f,J as g,W as h,Z as i,B as o,p as s,a as u};
